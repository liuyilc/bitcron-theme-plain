html
    head
        +h.headers
        +h.load('/template/style.scss', 'font')
        script(type='text/javascript').
            function isHidden(el) {
            var vDiv = el.parentNode.nextElementSibling
            vDiv.style.display = (vDiv.style.display == 'none')?'block':'none';//反转
            }

        block title
            if request.path.startswith('/tag/') and posts.tags
                title= posts.tags.join('+') + ' - ' + site.title
            elif request.path.startswith('/category/') and posts.category
                title= posts.category.title + ' - ' + site.title
            elif request.args.s
                title= request.args.s + ' - ' + site.title
            elif site.configs.sub_title
                title= site.title + ' - ' + site.configs.sub_title

    body
        header
            +font('hanazono')
                h1.title:a(href='/')= site.title
            .site_description
                span= site.configs.sub_title
            +site.just_nav
        main
            img.flowers(src="/template/image/Flower_01.svg", alt="")
            img.flowers_bottom(src="/template/image/Flower_02.svg", alt="")
            .post_main
                .post_border
                    block content
        if not request.path.startswith('/archive/')
            +h.paginator(pre_label="上一页",  next_label="下一页")

        script.
            (function() {

            var p = document.querySelectorAll('.content > p.md_block');
            var regex = /^\{\{(!)?(.*)\}\}$/;
            var len = p.length;
            for (var i = 0; i < len; i++) {
            var matches = p[i].firstElementChild.textContent.match(regex);
            if (!matches) {continue;}

            var legendHtml = '<p class="md_compiled md_paragraph_html"><legend class="foldup-caption" style="cursor:hand" onclick="isHidden(this)"></legend></p >'; // don't add unescaped matches[2] here
            
            var divHtml = '<div class="foldup" style="display:' + (matches[1] ? 'block' : 'none') + '">';
            var lines = p[i].children;
            var count = lines.length;
            for (var j = 1; j < count; j++) {
            divHtml += '<p>' + lines[j].innerHTML + '</p >';
            }
            divHtml += '</div>';
            p[i].insertAdjacentHTML('beforebegin', legendHtml);
            p[i].previousSibling.firstChild.textContent = matches[2];
            p[i].insertAdjacentHTML('beforebegin', divHtml);
            p[i].remove();
            }
            })()


    footer
        #credit
            span= '© ' + site.now.year
            span= site.title
        #siteinfo
            span= '%s篇文章' %(d.get_data(types='post', return_count=true, with_page=false))
            span= '%s字' %('{0:,}'.format(site.text_words))
            span.oh -
        #poweredby
            a(href='https://mytrix.in/post/zi-zhi/bitcron-theme-plain', target='_blank') 主题「素」
            | -
            a(href='https://bitcron.com', target='_blank') Powered by Bitcron
        +site.socials 

    +h.back_to_top(label='△')

